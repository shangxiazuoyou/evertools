# Excel 文件查看器

这是一个基于Web的Excel文件查看器，支持上传和查看多种格式的Excel文件。

## 功能特性

- 📁 支持多种文件格式：`.xlsx`, `.xls`, `.csv`
- 📊 多工作表支持
- 🎯 拖拽上传文件
- 📱 响应式设计，支持移动设备
- 🔄 同时处理多个文件
- ⚡ 实时数据预览
- 🎨 现代化UI设计
- 🎯 **用户体验优化**：
  - 📊 详细的上传和处理进度反馈
  - 🎬 流畅的加载动画和视觉效果
  - ❌ 智能错误提示和解决方案建议
  - 🔄 操作确认和一键撤销功能
  - 📱 完全响应式设计，优秀的移动端体验
  - ⌨️ 快捷键支持（ESC取消、触摸设备优化）
- 🚀 **性能优化**：
  - 📋 智能渲染策略（小数据直接渲染、中等数据虚拟滚动、大数据分页加载）
  - 🔧 Web Worker异步处理大文件，避免界面卡顿
  - 📈 优化的CSV解析器，批量处理提升性能
  - 💾 文件大小限制，防止内存溢出
  - 📊 进度条显示文件处理进度
- 🧠 **内存管理**：
  - 🔍 实时内存监控和可视化指示器
  - 🗑️ 智能缓存管理和自动清理机制
  - ⚡ 数据压缩和懒加载技术
  - 🔒 内存泄漏防护（WeakRef + FinalizationRegistry）
  - 📉 自适应降级策略（根据内存压力调整功能）
  - 🎯 DOM优化（DocumentFragment、批量操作、请求动画帧）

## 如何使用

1. 打开 `index.html` 文件
2. 点击上传区域或拖拽Excel文件到页面
3. 选择要查看的工作表（如果有多个）
4. 查看表格数据

## 支持的文件格式

- **XLSX**: Excel 2007及以上版本
- **XLS**: Excel 97-2003版本
- **CSV**: 逗号分隔值文件
  - 🔍 自动检测分隔符（逗号、分号、制表符、竖线）
  - 📝 智能编码处理（UTF-8、BOM检测）
  - 🎯 状态机解析，支持引号内换行
  - 🔢 自动类型推断（数字、日期、布尔值）

## 技术实现

- **前端**: HTML5, CSS3, JavaScript (ES6+)
- **Excel解析**: SheetJS (XLSX库)
- **样式**: 现代CSS Grid和Flexbox布局
- **兼容性**: 支持所有现代浏览器

## 项目结构

```
excel-viewer/
├── index.html          # 主页面
├── style.css           # 样式文件
├── script.js           # 主要逻辑
├── test-data.csv       # 测试数据
└── README.md          # 项目说明
```

## 开发说明

项目使用纯前端技术，无需服务器支持。直接在浏览器中打开`index.html`即可使用。

### 主要类和方法

- `ExcelViewer`: 主要的Excel查看器类
- `handleFiles()`: 处理文件上传
- `processFile()`: 解析Excel文件
- `renderTable()`: 渲染数据表格
- `parseCSV()`: 解析CSV文件

## 使用示例

1. 上传test-data.csv文件测试基本功能
2. 创建包含多个工作表的Excel文件测试工作表切换
3. 上传大型Excel文件测试性能

## 浏览器支持

- Chrome 60+
- Firefox 55+
- Safari 12+
- Edge 79+

## 性能规格

- **文件大小限制**: 最大支持50MB
- **处理策略**:
  - ≤1000行: 直接渲染，响应最快
  - 1001-10000行: 虚拟滚动，平滑体验
  - >10000行: 分页加载，内存友好
- **Web Worker**: 5MB以上文件自动启用后台处理
- **CSV优化**: 智能解析器，支持多种分隔符和编码格式

## 内存管理特性

- **智能监控**: 实时显示内存使用率，支持Chrome DevTools API
- **多级缓存**: 数据缓存、渲染缓存、分层过期策略
- **压缩技术**: 字符串去重压缩，可节省20-80%内存
- **懒加载**: 工作表按需加载，大表格分批处理
- **自动降级**: 根据内存压力自动调整功能和显示策略
- **泄漏防护**: WeakRef弱引用 + FinalizationRegistry清理
- **DOM优化**: DocumentFragment批量操作，减少重排重绘

## 注意事项

- 大文件使用Web Worker处理，首次加载可能需要几秒
- 分页模式下可自定义每页显示行数（100-2000行）
- 某些复杂的Excel功能（如公式、图表）暂不支持显示
- 建议在现代浏览器中使用以获得最佳性能